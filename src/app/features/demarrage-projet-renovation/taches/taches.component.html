
    
    <mat-tab-group mat-stretch-tabs class="header-card mat-elevation-z4 block p-0">
        <mat-tab label="Liste des taches" *ngIf="Gerant==1">
            <div fxLayout="row wrap" class=" button-add">
                <div class="table-bouton-ajout" >
                    <div *ngIf="isLoadingResults" fxLayout="column" fxLayoutAlign="center center" class="user-spinner mat-elevation-z8">   
                        <mat-spinner color="primary"></mat-spinner>
                      </div>
                    <mat-button-toggle-group appearance="legacy" >
                        <mat-button-toggle (click)="openDialog(null)" class="bg-primary">
                            <mat-icon>add_circle_outline</mat-icon>
                        </mat-button-toggle>
                    </mat-button-toggle-group>
                </div>
                    <div class="recherche">
                        <mat-form-field class="recherche">
                            <input matInput [(ngModel)]="rechercheGeneral" placeholder="Rechercher generale..." autocomplete="off" (keyup)="recherche()" [ngModelOptions]="{standalone: true}">
                            <mat-icon matSuffix (click)="rechercheGeneral = ''; recherche()" class="sycad-element-clickable">clear</mat-icon>
                        </mat-form-field>
                    </div>
              </div>
              <div fxLayout="row wrap">
                  <div fxFlex="100" class="flex-p"> 
                      <div class="example-container mat-elevation-z8">
                          <table mat-table [dataSource]="dataSources" matSort>
                        
                            <!-- Name Column -->
                            <ng-container matColumnDef="appellation">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header> Appellation </th>
                              <td mat-cell *matCellDef="let element"> {{element.appellation}} </td>
                            </ng-container>
                        
                            <!-- Position Column -->
                            <ng-container matColumnDef="description">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header> Description </th>
                              <td mat-cell *matCellDef="let element">
                                <button [matMenuTriggerFor]="descri" mat-button color="warn">Voir description</button>
                                <mat-menu #descri="matMenu">
                                  <mat-list>
                                      <mat-list-item>{{element.description}}</mat-list-item>
                                  </mat-list>
                                </mat-menu>
                              </td>
                            </ng-container>
                        
                            <!-- Weight Column -->
                            <ng-container matColumnDef="status">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                              <td mat-cell *matCellDef="let element"> {{element.niveauAvancer}} </td>
                            </ng-container>
              
                            <ng-container matColumnDef="dateD">
                              <th mat-header-cell *matHeaderCellDef > Date debut </th>
                              <td mat-cell *matCellDef="let element"> {{element.dateDemarrage | date : 'dd LLLL yyyy'}} </td>
                            </ng-container>
                        
                            <!-- Symbol Column -->
                            <ng-container matColumnDef="DateF">
                              <th mat-header-cell *matHeaderCellDef> Date Fin </th>
                              <td mat-cell *matCellDef="let element"> {{element.dateFinition | date : 'dd LLLL yyyy'}} </td>
                            </ng-container>
              
                            <ng-container matColumnDef="user">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header> user </th>
                              <td mat-cell *matCellDef="let element">
                                  <button [matMenuTriggerFor]="user" mat-icon-button>Voir+</button>
                                  <mat-menu #user="matMenu">
                                    <mat-list>
                                        <mat-list-item>Email: {{element.utilisateur.utilisateurs.email}}</mat-list-item>
                                        <mat-list-item>Nom: {{element.utilisateur.utilisateurs.civilite}} {{element.utilisateur.utilisateurs.nom}} {{element.utilisateur.utilisateurs.prenom}}</mat-list-item>
                                    </mat-list>
                                  </mat-menu>
                            </td>
                            </ng-container>

                            <ng-container matColumnDef="projet">
                              <th mat-header-cell *matHeaderCellDef> Projet </th>
                              <td mat-cell *matCellDef="let element"> {{element.id }} </td>
                            </ng-container>
                            
                            <!-- Star Column -->
                            <ng-container matColumnDef="action" stickyEnd>
                              <th mat-header-cell *matHeaderCellDef>Action</th>
                              <td mat-cell *matCellDef="let element">
                                  <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                                      <mat-icon>more_vert</mat-icon>
                                    </button>
                                    <mat-menu #menu="matMenu">
                                      <button mat-menu-item (click)="openDialog(element)">
                                        <mat-icon>edite</mat-icon>
                                        <span>Modifier</span>
                                      </button>
                                      <button mat-menu-item color="warn" (click)="supprimerRenovation(element.id)">
                                        <mat-icon>delete</mat-icon>
                                        <span>Supprimer</span>
                                      </button>
                                    </mat-menu>
                              </td>
                            </ng-container>
                        
                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                          </table>
                          <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
                        </div>
                  </div>
              </div>
        </mat-tab>
        <mat-tab label="Gestion des taches">
          
                <div fxLayout="row"  fxLayout.lt-md="row wrap">
                  <div *ngIf="isLoadingResults" fxLayout="column" fxLayoutAlign="center center" class="user-spinner mat-elevation-z8">   
                    <mat-spinner color="primary"></mat-spinner>
                  </div>
              <mat-card
              [fxFlex.xs]="100" [fxFlex.sm]="100" 
              [fxFlex.md]="100" [fxFlex.lg]="50" [fxFlex.xl]="50">
              <mat-card-header fxLayoutAlign="center center">
                  <mat-card-title>
                      Travail A Realiser
                  </mat-card-title>
              </mat-card-header>
                  <mat-card-content>
                      <div
                        cdkDropList
                        #aFaireList="cdkDropList"
                        [cdkDropListData]="aFaire"
                        [cdkDropListConnectedTo]="[encoursList,refaireList, validerList]"
                        class="example-list"
                        (cdkDropListDropped)="drop($event, 'AFAIRE')">
                          <div class="example-box init" *ngFor="let item of aFaire" fxLayout="column" cdkDrag>
                            <h4>{{item.appellation}}</h4>
                            <p  class="w-100"><i>date demarrage</i> : {{item.dateDemarrage | date : 'dd LLLL yyyy'}}</p>
                            <p  class="w-100"><i>Date finition </i>: {{item.dateFinition | date : 'dd LLLL yyyy'}} </p>
                            <p class="w-100"><i>Nombre de jour</i> : {{nombreJour(item)}} Jours</p>
                            <p class="w-100"><i>Assigné à</i> : {{item.utilisateur.utilisateurs.nom | uppercase}} {{item.utilisateur.utilisateurs.nom}}</p>
                            <span fxLayoutAlign="end center">
                              <button mat-icon-button (click)="voirPlus(item)">
                                  voir+
                              </button>
                          </span>
                          </div>
                          <div class="example-box init">
                            
                          </div>
                      </div>
                  </mat-card-content>
              </mat-card>
              <mat-card
              [fxFlex.xs]="100" [fxFlex.sm]="100" 
              [fxFlex.md]="100" [fxFlex.lg]="50" [fxFlex.xl]="50">
              <mat-card-header fxLayoutAlign="center center">
                  <mat-card-title>
                      Travail En Cours
                  </mat-card-title>
              </mat-card-header>
                  <mat-card-content>
                    <div
                        cdkDropList
                        #encoursList="cdkDropList"
                        [cdkDropListData]="enCours"
                        [cdkDropListConnectedTo]="[aFaireList,refaireList, validerList]"
                        class="example-list"
                        (cdkDropListDropped)="drop($event, 'ENCOURS')">
                          <div class="example-box encours" *ngFor="let item of enCours" fxLayout="column" cdkDrag>
                            <h4>{{item.appellation}}</h4>
                            <ng-select class="w-100" [items]="evolution"
                            [(ngModel)]="item.tauxProgression"
                            (change)="onChangePourcentage($event,item)"
                            placeholder="Evolution de la tache"
                            >

                            </ng-select>
                            <p class="w-100"><i>date demarrage</i> : {{item.dateDemarrage | date : 'dd LLLL yyyy'}}</p>
                            <p class="w-100"><i>Date finition </i>: {{item.dateFinition | date : 'dd LLLL yyyy'}} </p>
                            <p class="w-100"><i>Nombre de jour</i> : {{nombreJour(item)}} Jours</p>
                            <p class="w-100"><i>Assigné à</i> : {{item.utilisateur.utilisateurs.nom | uppercase}} {{item.utilisateur.utilisateurs.nom}}</p>
                            <span fxLayoutAlign="end center">
                              <button mat-icon-button (click)="voirPlus(item)">
                                  voir+
                              </button>
                              </span>
                          </div>

                          <div class="example-box encours">
                            
                          </div>
                      </div>
                  </mat-card-content>
              </mat-card>

              <mat-card
              [fxFlex.xs]="100" [fxFlex.sm]="100" 
              [fxFlex.md]="100" [fxFlex.lg]="50" [fxFlex.xl]="50">
              <mat-card-header fxLayoutAlign="center center">
                  <mat-card-title>
                      Travail A Refaire
                  </mat-card-title>
              </mat-card-header>
                  <mat-card-content>
                    <div
                    cdkDropList
                    #refaireList="cdkDropList"
                    [cdkDropListData]="aReFaire"
                    [cdkDropListConnectedTo]="[aFaireList, encoursList, validerList]"
                    class="example-list"
                    (cdkDropListDropped)="drop($event, 'AREFAIRE')">
                      <div class="example-box revoir" *ngFor="let item of aReFaire" fxLayout="column" cdkDrag>
                        <h4>{{item.appellation}}</h4>
                            <p class="w-100"><i>date demarrage</i> : {{item.dateDemarrage | date : 'dd LLLL yyyy'}}</p>
                            <p class="w-100"><i>Date finition </i>: {{item.dateFinition | date : 'dd LLLL yyyy'}} </p>
                            <p class="w-100"><i>Nombre de jour</i> : {{nombreJour(item)}} Jours</p>
                            <p class="w-100"><i>Assigné à</i> : {{item.utilisateur.utilisateurs.nom | uppercase}} {{item.utilisateur.utilisateurs.nom}}</p>
                            <span fxLayoutAlign="end center">
                              <button mat-icon-button (click)="voirPlus(item)">
                                  voir+
                              </button>
                            </span>
                      </div>
                      <div class="example-box revoir">
                            
                      </div>
                  </div>
                  </mat-card-content>
              </mat-card>

              <mat-card
              [fxFlex.xs]="100" [fxFlex.sm]="100" 
              [fxFlex.md]="100" [fxFlex.lg]="50" [fxFlex.xl]="50">
                  <mat-card-header fxLayoutAlign="center center">
                      <mat-card-title>
                          Travail Valider
                      </mat-card-title>
                  </mat-card-header>
                  <mat-card-content>
                    <div
                    cdkDropList
                    #validerList="cdkDropList"
                    [cdkDropListData]="valider"
                    [cdkDropListConnectedTo]="[aFaireList, encoursList,refaireList]"
                    class="example-list"
                    (cdkDropListDropped)="drop($event, 'VALIDER')">
                      <div class="example-box valider" *ngFor="let item of valider" fxLayout="column" cdkDrag>
                        <h4>{{item.appellation}}</h4>
                            <p class="w-100"><i>date demarrage</i> : {{item.dateDemarrage | date : 'dd LLLL yyyy'}}</p>
                            <p class="w-100"><i>Date finition </i>: {{item.dateFinition | date : 'dd LLLL yyyy'}} </p>
                            <p class="w-100"><i>Nombre de jour</i> : {{nombreJour(item)}} Jours</p>
                            <p class="w-100"><i>Assigné à</i> : {{item.utilisateur.utilisateurs.nom | uppercase}} {{item.utilisateur.utilisateurs.nom}}</p>
                            <span fxLayoutAlign="end center">
                              <button mat-icon-button (click)="voirPlus(item)">
                                  voir+
                              </button>
                           </span>
                      </div>
                      <div class="example-box valider">
                            
                      </div>
                  </div>
                  </mat-card-content>
              </mat-card>
      </div>
        </mat-tab>
      </mat-tab-group>
